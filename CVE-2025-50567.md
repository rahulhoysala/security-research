## CVE-2025-50567 : SQL Injection in Saurus CMS Community Edition v4.7.1

**Discovered by:** [Rahul Hoysala](https://www.linkedin.com/in/rahul-hoysala/)

**CVE ID:** CVE-2025-50567

**Severity:** Critical

**Status:** Public

**Date Published:** August 15, 2025

---

## 📝 Summary

A **critical SQL injection vulnerability** was discovered in the custom **DB::prepare function**, which uses **preg_replace()** with the deprecated **/e** modifier to interpolate SQL query parameters (deprecated in PHP 5.5 and removed in PHP 7) in **Saurus CMS Community Edition v4.7.1**. This leads to **direct evaluation of user-controlled SQL statements**, potentially leading to **arbitrary PHP code execution**. 

---

## ⚙️ Affected Component

- **File:** `classes/mysql.inc.php`
- **Function:** `prepare()`
- **Line:** [354](https://github.com/sauruscms/Saurus-CMS-Community-Edition/blob/master/classes/mysql.inc.php#L354)
- **Commit:** `6fffcf0`
- **Product:** Saurus CMS Community Edition v4.7.1
- **Vendor:** Saurus OÜ
- **Access Required:** None

---

## 📜 Vulnerability Details

The vulnerability lies in the funtion `prepare()`, in this particular line:
```php
$sql = preg_replace("/\?/e", '"\'".$args[++$i]."\'"', $sql, 50);
```
The `/e` modifier in `preg_replace()` evaluates the replacement string as PHP code. This allows an attacker to inject and execute arbitrary SQL queries. This can potentially lead to arbitrary code execution on the server. 

---

## 🎯 Impact

- Disclosure of sensitive data and PII
- Full control over database
- Potential RCE (Remote Code Execution)

---

## ✅ Proof of Concept

```php
' SELECT * FROM users WHERE username = 'admin' AND password = 'anything' OR '1'='1'
```
Parameter input is supposed to be accepted in a sanitized manner, but the problem arises with the `/e` modifier, which would replace the placeholder value with unsafe user-controlled parameters, which in this case is evaluated as SQL syntax and forms an attacker-controlled query. 

---

## 📊 CVSS Score

**Base Score:** 9.8 (Critical) 

**Vector:** `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H`

> Remote exploitation, low attack complexity, no privileges required, no user interaction required, unchanged scope, high loss of confidentiality, high loss of integrity, high loss of availability.

---

## 🛠️ Recommended Remediation

- Remove usage of `/e` modifier.
- Sanitize all SQL parameter input.
- Upgrade to PHP 7.0 or later.
- Remove the custom `prepare()` function.
- Use secure database abstraction layers like PDO or MySQLi.

---

## ⚡ Sample Remediation Code

Replace this:
```php
$sql = preg_replace("/\?/e", '"\'".$args[++$i]."\'"', $sql, 50);
```
with this:
```php
$sql = preg_replace_callback("/\?/", function($matches) use (&$i, $args) {
    return '\'' . $args[++$i] . '\'';
}, $sql, 50);
```
In this case, the `/e` modifier is replaced with `preg_replace_callback()`, the callback function takes the matched value and returns the safely quoted parameter from `$args[++$i]`, which is wrapped in single quotes to ensure proper SQL syntax.

---

## ⏰ Disclosure Timeline

| Date | Event |
|--------|---------|
| April 28, 2025 | Vulnerability discovered |
| April 29, 2025 | Contacted vendor with request for CVD (no response) |
| August 14, 2025 | CVE ID reserved by MITRE |
| August 15, 2025 | Public disclosure on GitHub|

> In compliance with Sections 4.2 and 5.3 of the CVE Entry Reference Requirement rules, and after having provided a period of 108 days for an attempt at coordinated vulnerability disclosure from the vendor, this finding is being officially made public.

---

## 🔗 References

CVE-2025-50567 - [Reserved on MITRE](https://www.cve.org/CVERecord?id=CVE-2025-50567)

Saurus CMS Community Edition v4.7.1 - [Affected Component](https://github.com/sauruscms/Saurus-CMS-Community-Edition/blob/master/classes/mysql.inc.php)

---

## 👨‍💻 About The Researcher

**Rahul Hoysala** is a student and security researcher specializing in web application security and full-scope infrastructure penetration testing, with experience in coordinated vulnerability disclosure across a range of organizations and vendors.  
