## CVE-2025-50567 : Unauthenticated SQL Injection leading to Remote Code Execution in Saurus CMS Community Edition v4.7.1

**Discovered by:** [Rahul Hoysala](https://www.linkedin.com/in/rahul-hoysala/)

**CVE ID:** CVE-2025-50567

**Severity:** Critical

**Status:** Public

**Date Published:** August 15, 2025

---

## üìù Summary

A **critical SQL injection vulnerability** was discovered in the custom **DB::prepare function**, which uses **preg_replace()** with the deprecated **/e** modifier to interpolate SQL query parameters (deprecated in PHP 5.5 and removed in PHP 7) in **Saurus CMS Community Edition v4.7.1**. This, along with unsafe parameter syntax escaping, leads to **direct evaluation of user-controlled SQL statements**, leading to **arbitrary code execution**. 

---

## ‚öôÔ∏è Affected Component

- **File:** `classes/mysql.inc.php`
- **Function:** `prepare()`
- **Line:** [354](https://github.com/sauruscms/Saurus-CMS-Community-Edition/blob/master/classes/mysql.inc.php#L354)
- **Commit:** `6fffcf0`
- **Product:** Saurus CMS Community Edition v4.7.1
- **Vendor:** Saurus O√ú
- **Access Required:** None

---

## üìú Vulnerability Details

The vulnerability lies in the funtion `prepare()`, in this particular line:
```php
$sql = preg_replace("/\?/e", '"\'".$args[++$i]."\'"', $sql, 50);
```
The `/e` modifier in `preg_replace()` evaluates the replacement string as PHP code. Additionally, the escaping implementation is unsafe, as crafted byte sequences using a multibyte charset like GBK/Big5 can leave the quote unescaped. This allows an attacker to inject and execute arbitrary SQL queries and can potentially lead to arbitrary code execution on the server. 

---

## üéØ Impact

- Disclosure of sensitive data and PII
- Full control over database
- Vector for RCE (Remote Code Execution)

---

## ‚úÖ Proof of Concept

```php
%BF%27 UNION SELECT null, username, password FROM users -- a
```
The multibyte sequence `%BF%27` is interpreted by MySQL as a single character in the GBK charset to break out of the intended quoting context. The `UNION SELECT` clause is then directly injected into the query, which allows for extraction of sensitive data from the `users` table. The trailing `-- a` ensures that there's a character or space to effectively 'activate' the comment. This is passed through the vulnerable `preg_replace()` call in the `prepare()` function as outlined earlier, which is passed through `$args`, which builds a full and unescaped payload that effectively executes the query and confirms the presence of SQL injection. 

Consider the following line:
```php
%BF%27 UNION SELECT "<?php system($_GET['cmd']); ?>", null, null INTO OUTFILE '/var/www/html/shell.php' -- a
```
In this case - using the GBK multibyte bypass and the unsafe argument parameterization in the `preg_replace()` function call, the attacker can write a malicious PHP payload directly into the web server's document root (commonly termed a 'web shell'). Once it is written, the attacker can access the file remotely and execute arbitrary system commands under the privileges of the web server process, confirming RCE (remote code execution). 

---

## üìä CVSS Score

**Base Score:** 10.0 (Critical) 

**Vector:** `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H`

> The attack can be carried out over the network layer, satisfying `AV:N`. This requires the attacker to be able to successfully craft valid escaped SQL queries, making the attack complexity low and satisying `AC:L`. Since this attack is carried out over any endpoint that invokes the database abstraction layer, this attack requires no privileges, satisfying `PR:N`. This does not require end user interaction, satisfying `UI:N`. The attacker can obtain a webshell leading to RCE on the host OS, effectively changing the scope of the security authority from Authority A (The CMS/web app in the application layer) to Authority B (the host OS and other services running on it), satisfying `S:C`. Attackers can extract sensitive data via crafted SQL queries, effectively compromising the confidentiality and satisfying `C:H`. Attackers can inject, modify or delete database contents at will, effectively compromising the integrity and satisfying `I:H`. Attackers can execute destructive operations like dropping tables or denying services at the OS level once RCE is achieved, thus compromising the availability and satisfying `A:H`. The combination of all these factors satisfies every condition under CVSS v3.1 for a severity rating of 10.0. 

---

## üõ†Ô∏è Recommended Remediation

- Remove usage of `/e` modifier.
- Sanitize all SQL parameter input.
- Upgrade to PHP 7.0 or later.
- Remove the custom `prepare()` function.
- Use secure database abstraction layers like PDO or MySQLi.

---

## ‚ö° Sample Remediation Code

Replace this:
```php
$sql = preg_replace("/\?/e", '"\'".$args[++$i]."\'"', $sql, 50);
return $sql;
```
with this:
```php
$pdo = new PDO('mysql:host=localhost;dbname=saurus', 'dbuser', 'dbpass', [
    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
]);
$stmt = $pdo->prepare("SELECT * FROM users WHERE username = ? AND password = ?"); //example query
$stmt->execute([$username, $password]);
$result = $stmt->fetchAll(PDO::FETCH_ASSOC);

```
In this case, the SQL string never directly concatenates user input, and the database driver handles quoting, escaping and type safety internally - thus addressing the core of the vulnerability. 

---

## ‚è∞ Disclosure Timeline

| Date | Event |
|--------|---------|
| April 28, 2025 | Vulnerability discovered |
| April 29, 2025 | Contacted vendor with request for CVD (no response) |
| August 14, 2025 | CVE ID reserved by MITRE |
| August 15, 2025 | Public disclosure on GitHub|

> In compliance with Sections 4.2 and 5.3 of the CVE Entry Reference Requirement rules, and after having provided a period of 108 days for an attempt at coordinated vulnerability disclosure from the vendor, this finding is being officially made public.

---

## üîó References

CVE-2025-50567 - [Reserved on MITRE](https://www.cve.org/CVERecord?id=CVE-2025-50567)

Saurus CMS Community Edition v4.7.1 - [Affected Component](https://github.com/sauruscms/Saurus-CMS-Community-Edition/blob/master/classes/mysql.inc.php)

---

## üë®‚Äçüíª About The Researcher

**Rahul Hoysala** is a student and security researcher specializing in web application security and full-scope infrastructure penetration testing, with experience in coordinated vulnerability disclosure across a range of organizations and vendors.  
